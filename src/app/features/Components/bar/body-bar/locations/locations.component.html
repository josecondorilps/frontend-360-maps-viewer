<div class="locations-container" [class.expanded]="isExpanded">
  <!-- Header -->
  <div class="locations-header">
    <h3>Ubicaciones</h3>
    <button
      class="toggle-btn"
      (click)="onToggleExpanded()"
      [attr.aria-expanded]="isExpanded">
      <i class="icon" [class]="isExpanded ? 'fas fa-chevron-up' : 'fas fa-chevron-down'"></i>
    </button>
  </div>

  <!-- Content -->
  <div class="locations-content" *ngIf="isExpanded">

    <!-- Loading State -->
    <div *ngIf="loading$ | async" class="loading-container">
      <div class="spinner"></div>
      <p>Cargando ubicaciones...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error$ | async as error" class="error-container">
      <div class="error-message">
        <i class="fas fa-exclamation-triangle"></i>
        <p>{{ error }}</p>
      </div>
      <button class="retry-btn" (click)="retryLoad()">
        <i class="fas fa-redo"></i>
        Reintentar
      </button>
    </div>

    <!-- Locations List -->
    <div *ngIf="locations$ | async as locations" class="locations-list">

      <!-- Empty State -->
      <div *ngIf="locations.length === 0 && !(loading$ | async) && !(error$ | async)"
           class="empty-state">
        <i class="fas fa-map-marker-alt"></i>
        <p>No hay ubicaciones disponibles</p>
      </div>

      <!-- Locations Items -->
      <button
        class="location-item"
        *ngFor="let location of locations; trackBy: trackByLocationId"
        (click)="onLocationClick(location)"
        [attr.data-location-id]="location.id"
        [class.active]="selectedLocationId === location.id"
        type="button"
      >
        <div class="location-info">
          <h4 class="location-name">{{ location.name }}</h4>
          <div class="location-details">
            <span class="company-id" *ngIf="location.company_id">
          <i class="fas fa-building"></i>
              {{ location.company_id }}
          </span>
              </div>
        </div>
        <div class="location-actions">
          <i class="fas fa-chevron-right"></i>
        </div>
      </button>
    </div>
  </div>
</div>
